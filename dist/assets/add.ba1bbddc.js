var E=Object.defineProperty,F=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var y=(t,o,r)=>o in t?E(t,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[o]=r,C=(t,o)=>{for(var r in o||(o={}))T.call(o,r)&&y(t,r,o[r]);if(k)for(var r of k(o))A.call(o,r)&&y(t,r,o[r]);return t},w=(t,o)=>F(t,N(o));import{a as x,B as R,E as z,T as B}from"./index.esm.77a649e9.js";import{_ as V,a as I,c as _}from"./index.19785c67.js";import{am as M,aq as O,u as S,r as $,au as j,E as c,o as H,b,av as q,t as K,d,e as U,n as D,w as m,j as i,g as G,k as J,i as L}from"./vendor.573e8a1f.js";function P(t,o){const{link:r="",fileName:n=""}=t;return`<a data-w-e-type="attachment" data-w-e-is-void data-w-e-is-inline data-link="${r}" data-fileName="${n}" href="${r}" target="_blank">${n}</a>`}const Q={type:"attachment",elemToHtml:P};x.elemsToHtml=[Q];R.registerModule(x);const W={name:"culture_add",components:{Editor:z,Toolbar:B},setup(){const t=M(null),o=O(),r=S(),{id:n}=o.query,s=$({token:"Bearer "+I("token")||"",id:n,cultureForm:{content:""},rules:{content:[{required:!1,message:"\u5185\u5BB9\u5FC5\u987B",trigger:["change"]}]}}),u=j(),p={insertKeys:{index:31,keys:["uploadAttachment"]}},h={placeholder:"\u8BF7\u8F93\u5165\u5185\u5BB9...",hoverbarKeys:{attachment:{menuKeys:["downloadAttachment"]}},MENU_CONF:{uploadImage:{server:_,fieldName:"file",maxFileSize:2*1024*1024,maxNumberOfFiles:10,allowedFileTypes:["image/*"],meta:{basket:"img"},headers:{Authorization:s.token},customInsert:function(e,a){a(e.data.src,e.data.file_name,e.data.src)},onError(e,a,l){c.error(new Error(a).message),console.log(e,a,l)}},uploadVideo:{server:_,fieldName:"file",maxFileSize:100*1024*1024,allowedFileTypes:["video/*"],meta:{basket:"video"},headers:{Authorization:s.token},customInsert:function(e,a){a(e.data.src)},onError(e,a,l){c.error(new Error(a).message),console.log(e,a,l)}},uploadAttachment:{server:_,fieldName:"file",maxFileSize:10*1024*1024,meta:{basket:"attachment"},headers:{Authorization:s.token},customInsert:function(e,a,l){l(`${a.name}`,e.data.src)},onError(e,a,l){c.error(new Error(a).message),console.log(e,a,l)}}}},f=e=>{u.value=e};H(()=>{n&&b.get(`/api/back/cultures/${n}`).then(e=>{s.cultureForm={content:e.data.content}})}),q(()=>{const e=u.value;e!=null&&e.destroy()});const g=()=>{t.value.validate(e=>{if(e){let a=b.post,l={content:s.cultureForm.content},v="/api/back/cultures";n&&(a=b.put,v=`/api/back/cultures/${n}`),a(v,l).then(()=>{n?c.success("\u4FEE\u6539\u6210\u529F"):c.success("\u6DFB\u52A0\u6210\u529F"),r.push({path:"/culture"})})}})};return w(C({},K(s)),{editorRef:u,mode:"default",toolbarConfig:p,editorConfig:h,handleCreated:f,cultureRef:t,submitAdd:g})}},X={style:{border:"1px solid #ccc","z-index":"100"}};function Y(t,o,r,n,s,u){const p=d("Toolbar"),h=d("Editor"),f=d("el-form-item"),g=d("el-button"),e=d("el-form"),a=d("el-card");return U(),D(a,{style:{"min-height":"100%"}},{default:m(()=>[i(e,{model:t.cultureForm,rules:t.rules,ref:"cultureRef","label-width":"100px",style:{"margin-top":"30px"}},{default:m(()=>[i(f,{label:"\u5185\u5BB9",prop:"content"},{default:m(()=>[G("div",X,[i(p,{style:{"border-bottom":"1px solid #ccc"},editor:n.editorRef,defaultConfig:n.toolbarConfig,mode:n.mode},null,8,["editor","defaultConfig","mode"]),i(h,{style:{height:"500px","overflow-y":"hidden"},modelValue:t.cultureForm.content,"onUpdate:modelValue":o[0]||(o[0]=l=>t.cultureForm.content=l),defaultConfig:n.editorConfig,mode:n.mode,onOnCreated:n.handleCreated},null,8,["modelValue","defaultConfig","mode","onOnCreated"])])]),_:1}),i(f,null,{default:m(()=>[i(g,{type:"primary",onClick:o[1]||(o[1]=l=>n.submitAdd())},{default:m(()=>[J(L(t.id?"\u7ACB\u5373\u4FEE\u6539":"\u7ACB\u5373\u521B\u5EFA"),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})}var ae=V(W,[["render",Y]]);export{ae as default};
