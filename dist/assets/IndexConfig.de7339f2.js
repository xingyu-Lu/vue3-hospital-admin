var $=Object.defineProperty,E=Object.defineProperties;var x=Object.getOwnPropertyDescriptors;var V=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var S=(e,n,o)=>n in e?$(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o,F=(e,n)=>{for(var o in n||(n={}))A.call(n,o)&&S(e,o,n[o]);if(V)for(var o of V(n))G.call(n,o)&&S(e,o,n[o]);return e},k=(e,n)=>E(e,x(n));import{_ as I,h as D}from"./index.0a6d330b.js";import{ad as w,r as U,t as N,d as m,e as T,n as P,w as r,g as y,j as t,E as p,b as f,k as C,u as j,ah as B,o as q,m as M,aj as H,f as O,ak as J,al as K,i as L,p as Q,l as W}from"./vendor.49ed2502.js";const X={name:"DialogAddHotGood",props:{type:String,configType:Number,reload:Function},setup(e){const n=w(null),o=U({visible:!1,ruleForm:{name:"",link:"",id:"",sort:""},rules:{name:[{required:"true",message:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A",trigger:["change"]}],id:[{required:"true",message:"\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A",trigger:["change"]}],sort:[{required:"true",message:"\u6392\u5E8F\u4E0D\u80FD\u4E3A\u7A7A",trigger:["change"]}]},id:""}),u=i=>{f.get(`/indexConfigs/${i}`).then(s=>{o.ruleForm={name:s.configName,id:s.goodsId,link:s.redirectUrl,sort:s.configRank}})},l=i=>{o.visible=!0,i?(o.id=i,u(i)):o.ruleForm={name:"",id:"",link:"",sort:""}},_=()=>{o.visible=!1},d=()=>{n.value.validate(i=>{if(i){if(D(o.ruleForm.name)||D(o.ruleForm.link)){p.error("\u4E0D\u8981\u8F93\u5165\u8868\u60C5\u5305\uFF0C\u518D\u8F93\u5165\u5C31\u6253\u6B7B\u4F60\u4E2A\u9F9F\u5B59\u513F~");return}if(o.ruleForm.name.length>128){p.error("\u5546\u54C1\u540D\u79F0\u4E0D\u80FD\u8D85\u8FC7128\u4E2A\u5B57\u7B26");return}if(o.ruleForm.sort<0||o.ruleForm.sort>200){p.error("\u6392\u5E8F\u503C\u4E0D\u80FD\u5C0F\u4E8E 0 \u6216\u5927\u4E8E 200");return}e.type=="add"?f.post("/indexConfigs",{configType:e.configType||3,configName:o.ruleForm.name,redirectUrl:o.ruleForm.link,goodsId:o.ruleForm.id,configRank:o.ruleForm.sort}).then(()=>{p.success("\u6DFB\u52A0\u6210\u529F"),o.visible=!1,e.reload&&e.reload()}):f.put("/indexConfigs",{configId:o.id,configType:e.configType||3,configName:o.ruleForm.name,redirectUrl:o.ruleForm.link,goodsId:o.ruleForm.id,configRank:o.ruleForm.sort}).then(()=>{p.success("\u4FEE\u6539\u6210\u529F"),o.visible=!1,e.reload&&e.reload()})}})};return k(F({},N(o)),{open:l,close:_,formRef:n,submitForm:d})}},Y={class:"dialog-footer"},Z=C("\u53D6 \u6D88"),ee=C("\u786E \u5B9A");function oe(e,n,o,u,l,_){const d=m("el-input"),i=m("el-form-item"),s=m("el-form"),g=m("el-button"),h=m("el-dialog");return T(),P(h,{title:o.type=="add"?"\u6DFB\u52A0\u5546\u54C1":"\u4FEE\u6539\u5546\u54C1",modelValue:e.visible,"onUpdate:modelValue":n[5]||(n[5]=c=>e.visible=c),width:"400px"},{footer:r(()=>[y("span",Y,[t(g,{onClick:n[4]||(n[4]=c=>e.visible=!1)},{default:r(()=>[Z]),_:1}),t(g,{type:"primary",onClick:u.submitForm},{default:r(()=>[ee]),_:1},8,["onClick"])])]),default:r(()=>[t(s,{model:e.ruleForm,rules:e.rules,ref:"formRef","label-width":"100px",class:"good-form"},{default:r(()=>[t(i,{label:"\u5546\u54C1\u540D\u79F0",prop:"name"},{default:r(()=>[t(d,{type:"text",modelValue:e.ruleForm.name,"onUpdate:modelValue":n[0]||(n[0]=c=>e.ruleForm.name=c)},null,8,["modelValue"])]),_:1}),t(i,{label:"\u8DF3\u8F6C\u94FE\u63A5",prop:"link"},{default:r(()=>[t(d,{type:"text",modelValue:e.ruleForm.link,"onUpdate:modelValue":n[1]||(n[1]=c=>e.ruleForm.link=c)},null,8,["modelValue"])]),_:1}),t(i,{label:"\u5546\u54C1\u7F16\u53F7",prop:"id"},{default:r(()=>[t(d,{type:"number",min:"0",modelValue:e.ruleForm.id,"onUpdate:modelValue":n[2]||(n[2]=c=>e.ruleForm.id=c)},null,8,["modelValue"])]),_:1}),t(i,{label:"\u6392\u5E8F\u503C",prop:"sort"},{default:r(()=>[t(d,{type:"number",modelValue:e.ruleForm.sort,"onUpdate:modelValue":n[3]||(n[3]=c=>e.ruleForm.sort=c)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}var ne=I(X,[["render",oe]]);const R={hot:3,new:4,recommend:5},te={name:"Hot",components:{DialogAddGood:ne},setup(){const e=j(),n=B(),o=w(null),u=w(null),l=U({loading:!1,tableData:[],multipleSelection:[],total:0,currentPage:1,pageSize:10,type:"add",configType:3}),_=e.beforeEach(a=>{["hot","new","recommend"].includes(a.name)&&(l.configType=R[a.name],l.currentPage=1,d())});q(()=>{l.configType=R[n.name],d()}),M(()=>{_()});const d=()=>{l.loading=!0,f.get("/indexConfigs",{params:{pageNumber:l.currentPage,pageSize:l.pageSize,configType:l.configType}}).then(a=>{l.tableData=a.list,l.total=a.totalCount,l.currentPage=a.currPage,l.loading=!1})},i=()=>{l.type="add",u.value.open()},s=a=>{l.type="edit",u.value.open(a)},g=a=>{l.multipleSelection=a},h=()=>{if(!l.multipleSelection.length){p.error("\u8BF7\u9009\u62E9\u9879");return}f.post("/indexConfigs/delete",{ids:l.multipleSelection.map(a=>a.configId)}).then(()=>{p.success("\u5220\u9664\u6210\u529F"),d()})},c=a=>{f.post("/indexConfigs/delete",{ids:[a]}).then(()=>{p.success("\u5220\u9664\u6210\u529F"),d()})},v=a=>{l.currentPage=a,d()};return k(F({},N(l)),{multipleTable:o,handleSelectionChange:g,addGood:u,handleAdd:i,handleEdit:s,handleDelete:h,handleDeleteOne:c,getIndexConfig:d,changePage:v})}},le=e=>(Q("data-v-6612c262"),e=e(),W(),e),ae={class:"header"},re=C("\u589E\u52A0"),ie=C("\u6279\u91CF\u5220\u9664"),de=["href"],se=["onClick"],ue=le(()=>y("a",{style:{cursor:"pointer"}},"\u5220\u9664",-1));function ce(e,n,o,u,l,_){const d=m("el-button"),i=m("el-popconfirm"),s=m("el-table-column"),g=m("el-table"),h=m("el-pagination"),c=m("el-card"),v=m("DialogAddGood"),a=H("loading");return T(),O(J,null,[t(c,{class:"index-container"},{header:r(()=>[y("div",ae,[t(d,{type:"primary",size:"small",icon:"el-icon-plus",onClick:u.handleAdd},{default:r(()=>[re]),_:1},8,["onClick"]),t(i,{title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",onConfirm:u.handleDelete},{reference:r(()=>[t(d,{type:"danger",size:"small",icon:"el-icon-delete"},{default:r(()=>[ie]),_:1})]),_:1},8,["onConfirm"])])]),default:r(()=>[K((T(),P(g,{ref:"multipleTable",data:e.tableData,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:u.handleSelectionChange},{default:r(()=>[t(s,{type:"selection",width:"55"}),t(s,{prop:"configName",label:"\u5546\u54C1\u540D\u79F0"}),t(s,{label:"\u8DF3\u8F6C\u94FE\u63A5"},{default:r(b=>[y("a",{target:"_blank",href:b.row.redirectUrl},L(b.row.redirectUrl),9,de)]),_:1}),t(s,{prop:"configRank",label:"\u6392\u5E8F\u503C",width:"120"}),t(s,{prop:"goodsId",label:"\u5546\u54C1\u7F16\u53F7",width:"200"}),t(s,{prop:"createTime",label:"\u6DFB\u52A0\u65F6\u95F4",width:"200"}),t(s,{label:"\u64CD\u4F5C",width:"100"},{default:r(b=>[y("a",{style:{cursor:"pointer","margin-right":"10px"},onClick:z=>u.handleEdit(b.row.configId)},"\u4FEE\u6539",8,se),t(i,{title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",onConfirm:z=>u.handleDeleteOne(b.row.configId)},{reference:r(()=>[ue]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[a,e.loading]]),t(h,{background:"",layout:"prev, pager, next",total:e.total,"page-size":e.pageSize,"current-page":e.currentPage,onCurrentChange:u.changePage},null,8,["total","page-size","current-page","onCurrentChange"])]),_:1}),t(v,{ref:"addGood",reload:u.getIndexConfig,type:e.type,configType:e.configType},null,8,["reload","type","configType"])],64)}var fe=I(te,[["render",ce],["__scopeId","data-v-6612c262"]]);export{fe as default};
