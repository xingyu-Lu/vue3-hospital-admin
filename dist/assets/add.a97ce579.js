var x=Object.defineProperty,V=Object.defineProperties;var w=Object.getOwnPropertyDescriptors;var h=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var _=(t,o,a)=>o in t?x(t,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[o]=a,k=(t,o)=>{for(var a in o||(o={}))j.call(o,a)&&_(t,a,o[a]);if(h)for(var a of h(o))A.call(o,a)&&_(t,a,o[a]);return t},b=(t,o)=>V(t,w(o));import{W as S}from"./wangEditor.860a6779.js";import{_ as $,a as B,c as y}from"./index.fe2c4cb7.js";import{ak as I,ao as H,u as M,r as N,o as R,b as p,as as z,t as E,d as l,e as F,n as L,w as c,E as v,j as d,g as C,k as q,i as O}from"./vendor.15e5bf5f.js";const P={name:"history_add",setup(){const t=I(null),o=I(null),a=H(),u=M(),{id:i}=a.query,r=N({token:"Bearer "+B("token")||"",id:i,historyForm:{content:""},rules:{content:[{required:!1,message:"\u5185\u5BB9\u5FC5\u987B",trigger:["change"]}]}});let e;R(()=>{e=new S(t.value),e.config.showLinkImg=!1,e.config.showLinkImgAlt=!1,e.config.showLinkImgHref=!1,e.config.uploadImgMaxSize=10*1024*1024,e.config.uploadImgMaxLength=1,e.config.uploadImgAccept=["jpg","jpeg","png","gif","bmp","webp"],e.config.uploadFileName="file",e.config.uploadImgHeaders={Authorization:r.token},e.config.uploadImgParams={basket:"img"},e.config.uploadImgHooks={customInsert:function(n,s){console.log("result",s),n(s.data.src)}},e.config.uploadImgServer=y,Object.assign(e.config,{onchange(){console.log("change")}}),e.config.uploadVideoServer=y,e.config.uploadVideoMaxSize=1*200*1024*1024,e.config.uploadVideoAccept=["mp4"],e.config.uploadVideoParams={basket:"video"},e.config.uploadVideoName="file",e.config.uploadVideoHeaders={Authorization:r.token},e.config.uploadVideoHooks={customInsert:function(n,s){console.log("customInsert",s),n(s.data.src)}},e.create(),i&&p.get(`/api/back/historys/${i}`).then(n=>{r.historyForm={content:n.data.content},e&&e.txt.html(n.data.content)})}),z(()=>{e.destroy(),e=null});const f=()=>{o.value.validate(n=>{if(n){let s=p.post,m={content:e.txt.html()},g="/api/back/historys";i&&(s=p.put,g=`/api/back/historys/${i}`),s(g,m).then(()=>{i?v.success("\u4FEE\u6539\u6210\u529F"):v.success("\u6DFB\u52A0\u6210\u529F"),u.push({path:"/history"})})}})};return b(k({},E(r)),{editor:t,historyRef:o,submitAdd:f})}},W={ref:"editor"};function D(t,o,a,u,i,r){const e=l("el-form-item"),f=l("el-button"),n=l("el-form"),s=l("el-card");return F(),L(s,{style:{"min-height":"100%"}},{default:c(()=>[d(n,{model:t.historyForm,rules:t.rules,ref:"historyRef","label-width":"100px",style:{"margin-top":"30px"}},{default:c(()=>[d(e,{label:"\u5185\u5BB9",prop:"content"},{default:c(()=>[C("div",W,null,512)]),_:1}),d(e,null,{default:c(()=>[d(f,{type:"primary",onClick:o[0]||(o[0]=m=>u.submitAdd())},{default:c(()=>[q(O(t.id?"\u7ACB\u5373\u4FEE\u6539":"\u7ACB\u5373\u521B\u5EFA"),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1})}var K=$(P,[["render",D]]);export{K as default};
