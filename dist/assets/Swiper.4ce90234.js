var A=Object.defineProperty,R=Object.defineProperties;var B=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var U=(l,o,e)=>o in l?A(l,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[o]=e,w=(l,o)=>{for(var e in o||(o={}))E.call(o,e)&&U(l,e,o[e]);if(D)for(var e of D(o))N.call(o,e)&&U(l,e,o[e]);return l},S=(l,o)=>R(l,B(o));import{_ as V,u as T,b as G,h as q}from"./index.0a6d330b.js";import{ad as C,r as j,t as I,d,e as v,n as z,w as n,g,j as a,f as F,E as _,b as f,k,o as x,aj as M,ak as O,al as H,i as J,p as K,l as L}from"./vendor.49ed2502.js";const Q={name:"DialogAddSwiper",props:{type:String,reload:Function},setup(l){const o=C(null),e=j({uploadImgServer:T,token:G("token")||"",visible:!1,ruleForm:{url:"",link:"",sort:""},rules:{url:[{required:"true",message:"\u56FE\u7247\u4E0D\u80FD\u4E3A\u7A7A",trigger:["change"]}],sort:[{required:"true",message:"\u6392\u5E8F\u4E0D\u80FD\u4E3A\u7A7A",trigger:["change"]}]},id:""}),r=s=>{f.get(`/carousels/${s}`).then(t=>{e.ruleForm={url:t.carouselUrl,link:t.redirectUrl,sort:t.carouselRank}})},h=s=>{const t=s.name.split(".")[1]||"";if(!["jpg","jpeg","png"].includes(t))return _.error("\u8BF7\u4E0A\u4F20 jpg\u3001jpeg\u3001png \u683C\u5F0F\u7684\u56FE\u7247"),!1},b=s=>{e.ruleForm.url=s.data||""},u=s=>{e.visible=!0,s?(e.id=s,r(s)):e.ruleForm={url:"",link:"",sort:""}},c=()=>{e.visible=!1},i=()=>{console.log(o.value.validate),o.value.validate(s=>{if(s){if(q(e.ruleForm.link)){_.error("\u4E0D\u8981\u8F93\u5165\u8868\u60C5\u5305\uFF0C\u518D\u8F93\u5165\u5C31\u6253\u6B7B\u4F60\u4E2A\u9F9F\u5B59\u513F~");return}l.type=="add"?f.post("/carousels",{carouselUrl:e.ruleForm.url,redirectUrl:e.ruleForm.link,carouselRank:e.ruleForm.sort}).then(()=>{_.success("\u6DFB\u52A0\u6210\u529F"),e.visible=!1,l.reload&&l.reload()}):f.put("/carousels",{carouselId:e.id,carouselUrl:e.ruleForm.url,redirectUrl:e.ruleForm.link,carouselRank:e.ruleForm.sort}).then(()=>{_.success("\u4FEE\u6539\u6210\u529F"),e.visible=!1,l.reload&&l.reload()})}})};return S(w({},I(e)),{open:u,close:c,formRef:o,handleBeforeUpload:h,handleUrlSuccess:b,submitForm:i})}},W=["src"],X={key:1,class:"el-icon-plus avatar-uploader-icon"},Y={class:"dialog-footer"},Z=k("\u53D6 \u6D88"),ee=k("\u786E \u5B9A");function le(l,o,e,r,h,b){const u=d("el-upload"),c=d("el-form-item"),i=d("el-input"),s=d("el-form"),t=d("el-button"),y=d("el-dialog");return v(),z(y,{title:e.type=="add"?"\u6DFB\u52A0\u8F6E\u64AD\u56FE":"\u4FEE\u6539\u8F6E\u64AD\u56FE",modelValue:l.visible,"onUpdate:modelValue":o[3]||(o[3]=p=>l.visible=p),width:"400px"},{footer:n(()=>[g("span",Y,[a(t,{onClick:o[2]||(o[2]=p=>l.visible=!1)},{default:n(()=>[Z]),_:1}),a(t,{type:"primary",onClick:r.submitForm},{default:n(()=>[ee]),_:1},8,["onClick"])])]),default:n(()=>[a(s,{model:l.ruleForm,rules:l.rules,ref:"formRef","label-width":"100px",class:"good-form"},{default:n(()=>[a(c,{label:"\u56FE\u7247",prop:"url"},{default:n(()=>[a(u,{class:"avatar-uploader",action:l.uploadImgServer,accept:"jpg,jpeg,png",headers:{token:l.token},"show-file-list":!1,"before-upload":r.handleBeforeUpload,"on-success":r.handleUrlSuccess},{default:n(()=>[l.ruleForm.url?(v(),F("img",{key:0,style:{width:"200px",height:"100px",border:"1px solid #e9e9e9"},src:l.ruleForm.url,class:"avatar"},null,8,W)):(v(),F("i",X))]),_:1},8,["action","headers","before-upload","on-success"])]),_:1}),a(c,{label:"\u8DF3\u8F6C\u94FE\u63A5",prop:"link"},{default:n(()=>[a(i,{type:"text",modelValue:l.ruleForm.link,"onUpdate:modelValue":o[0]||(o[0]=p=>l.ruleForm.link=p)},null,8,["modelValue"])]),_:1}),a(c,{label:"\u6392\u5E8F\u503C",prop:"sort"},{default:n(()=>[a(i,{type:"number",modelValue:l.ruleForm.sort,"onUpdate:modelValue":o[1]||(o[1]=p=>l.ruleForm.sort=p)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])}var oe=V(Q,[["render",le],["__scopeId","data-v-24de3a3f"]]);const te={name:"Swiper",components:{DialogAddSwiper:oe},setup(){const l=C(null),o=C(null),e=j({loading:!1,tableData:[],multipleSelection:[],total:0,currentPage:1,pageSize:10,type:"add"});x(()=>{r()});const r=()=>{e.loading=!0,f.get("/carousels",{params:{pageNumber:e.currentPage,pageSize:e.pageSize}}).then(t=>{e.tableData=t.list,e.total=t.totalCount,e.currentPage=t.currPage,e.loading=!1})},h=()=>{e.type="add",o.value.open()},b=t=>{e.type="edit",o.value.open(t)},u=t=>{e.multipleSelection=t},c=()=>{if(!e.multipleSelection.length){_.error("\u8BF7\u9009\u62E9\u9879");return}f.delete("/carousels",{data:{ids:e.multipleSelection.map(t=>t.carouselId)}}).then(()=>{_.success("\u5220\u9664\u6210\u529F"),r()})},i=t=>{f.delete("/carousels",{data:{ids:[t]}}).then(()=>{_.success("\u5220\u9664\u6210\u529F"),r()})},s=t=>{e.currentPage=t,r()};return S(w({},I(e)),{multipleTable:l,handleSelectionChange:u,addGood:o,handleAdd:h,handleEdit:b,handleDelete:c,handleDeleteOne:i,getCarousels:r,changePage:s})}},ae=l=>(K("data-v-5ef7cdc0"),l=l(),L(),l),re={class:"header"},ne=k("\u589E\u52A0"),se=k("\u6279\u91CF\u5220\u9664"),ie=["src"],de=["href"],ce=["onClick"],ue=ae(()=>g("a",{style:{cursor:"pointer"}},"\u5220\u9664",-1));function pe(l,o,e,r,h,b){const u=d("el-button"),c=d("el-popconfirm"),i=d("el-table-column"),s=d("el-table"),t=d("el-pagination"),y=d("el-card"),p=d("DialogAddSwiper"),P=M("loading");return v(),F(O,null,[a(y,{class:"swiper-container"},{header:n(()=>[g("div",re,[a(u,{type:"primary",size:"small",icon:"el-icon-plus",onClick:r.handleAdd},{default:n(()=>[ne]),_:1},8,["onClick"]),a(c,{title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",onConfirm:r.handleDelete},{reference:n(()=>[a(u,{type:"danger",size:"small",icon:"el-icon-delete"},{default:n(()=>[se]),_:1})]),_:1},8,["onConfirm"])])]),default:n(()=>[H((v(),z(s,{ref:"multipleTable",data:l.tableData,"tooltip-effect":"dark",style:{width:"100%"},onSelectionChange:r.handleSelectionChange},{default:n(()=>[a(i,{type:"selection",width:"55"}),a(i,{label:"\u8F6E\u64AD\u56FE",width:"200"},{default:n(m=>[g("img",{style:{width:"150px",height:"150px"},src:m.row.carouselUrl,alt:"\u8F6E\u64AD\u56FE"},null,8,ie)]),_:1}),a(i,{label:"\u8DF3\u8F6C\u94FE\u63A5"},{default:n(m=>[g("a",{target:"_blank",href:m.row.redirectUrl},J(m.row.redirectUrl),9,de)]),_:1}),a(i,{prop:"carouselRank",label:"\u6392\u5E8F\u503C",width:"120"}),a(i,{prop:"createTime",label:"\u6DFB\u52A0\u65F6\u95F4",width:"200"}),a(i,{label:"\u64CD\u4F5C",width:"100"},{default:n(m=>[g("a",{style:{cursor:"pointer","margin-right":"10px"},onClick:$=>r.handleEdit(m.row.carouselId)},"\u4FEE\u6539",8,ce),a(c,{title:"\u786E\u5B9A\u5220\u9664\u5417\uFF1F",onConfirm:$=>r.handleDeleteOne(m.row.carouselId)},{reference:n(()=>[ue]),_:2},1032,["onConfirm"])]),_:1})]),_:1},8,["data","onSelectionChange"])),[[P,l.loading]]),a(t,{background:"",layout:"prev, pager, next",total:l.total,"page-size":l.pageSize,"current-page":l.currentPage,onCurrentChange:r.changePage},null,8,["total","page-size","current-page","onCurrentChange"])]),_:1}),a(p,{ref:"addGood",reload:r.getCarousels,type:l.type},null,8,["reload","type"])],64)}var fe=V(te,[["render",pe],["__scopeId","data-v-5ef7cdc0"]]);export{fe as default};
